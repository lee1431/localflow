<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>LocalFlow Â· ì¿ í°ë‚˜ë¬´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f7;
      color: #222;
    }
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #ddd;
      background: #fff;
    }
    header h1 {
      font-size: 1.4rem;
      font-weight: 700;
    }
    header p {
      margin-top: 0.3rem;
      font-size: 0.9rem;
      color: #666;
    }

    .layout {
      flex: 1;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr) minmax(0, 1.2fr);
      gap: 1rem;
      padding: 1rem 1.5rem 1.5rem;
    }

    /* ì¿ í° ê·¸ë¦¬ë“œ */
    .coupon-panel {
      background: #fff;
      border-radius: 14px;
      padding: 0.8rem;
      border: 1px solid #e4e4e7;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
      overflow: hidden;
    }

    .coupon-panel h2 {
      font-size: 0.95rem;
      margin-bottom: 0.2rem;
    }

    .coupon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 0.6rem;
      font-size: 0.8rem;
    }

    .coupon-card {
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      background: #fafafa;
      padding: 0.5rem 0.6rem;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }
    .coupon-card strong {
      font-size: 0.85rem;
    }
    .coupon-meta {
      display: flex;
      justify-content: space-between;
      font-size: 0.7rem;
      color: #666;
    }

    /* ì¤‘ì•™ ë‚˜ë¬´ ì˜ì—­ */
    .tree-panel {
      position: relative;
      background: linear-gradient(to bottom, #d7f3ff 0%, #fefae0 60%, #f5f5f5 100%);
      border-radius: 18px;
      border: 1px solid #e2e8f0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      padding: 0.8rem 0.8rem 1rem;
      align-items: center;
      justify-content: space-between;
    }

    .tree-top-text {
      font-size: 0.8rem;
      color: #555;
      text-align: center;
      margin-bottom: 0.4rem;
    }

    .tree-area {
      flex: 1;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .tree-hitbox {
      width: 180px;
      height: 260px;
      position: relative;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
    }

    .tree-body {
      width: 100%;
      height: 100%;
      border-radius: 999px 999px 30px 30px;
      background: radial-gradient(circle at 30% 10%, #a3e635, #4ade80 50%, #15803d 100%);
      position: relative;
      box-shadow: 0 12px 25px rgba(22, 163, 74, 0.35);
      transform-origin: bottom center;
      transition: transform 0.08s ease-out;
    }

    /* ë‚˜ë¬´ ì¤„ê¸° */
    .tree-trunk {
      position: absolute;
      bottom: -40px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 70px;
      border-radius: 999px;
      background: linear-gradient(to bottom, #92400e, #451a03);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.25);
    }

    /* ì–¼êµ´ ë¸”ëŸ¬ ì˜ì—­ */
    .face-blur {
      position: absolute;
      top: 30%;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      filter: blur(4px);
      opacity: 0.8;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .face-blur img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* ë‚˜ë¬´ í”ë“¤ë¦¼ */
    .tree-body.shake {
      animation: tree-shake 0.15s ease-in-out 1;
    }
    @keyframes tree-shake {
      0%   { transform: rotate(0deg); }
      25%  { transform: rotate(-3deg); }
      50%  { transform: rotate(3deg); }
      75%  { transform: rotate(-2deg); }
      100% { transform: rotate(0deg); }
    }

    /* ë–¨ì–´ì§€ëŠ” ì¿ í° */
    .falling-coupon {
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      padding: 0.4rem 0.5rem;
      background: #fbbf24;
      color: #111827;
      font-size: 0.8rem;
      border-radius: 10px;
      box-shadow: 0 10px 18px rgba(0, 0, 0, 0.25);
      animation: fall-down 0.9s ease-in forwards;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      text-align: center;
    }

    .falling-coupon small {
      font-size: 0.65rem;
      opacity: 0.8;
    }

    @keyframes fall-down {
      0%   { transform: translate(-50%, -20px); opacity: 0; }
      40%  { opacity: 1; }
      100% { transform: translate(-50%, 120px); opacity: 0; }
    }

    .tree-bottom {
      margin-top: 0.4rem;
      width: 100%;
      font-size: 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      align-items: center;
      text-align: center;
    }

    .tree-stats {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      color: #444;
    }

    .tree-hint {
      color: #888;
      font-size: 0.7rem;
    }

    /* ê°„ë‹¨ ëª¨ë‹¬ */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .modal {
      background: #fff;
      padding: 1rem 1.2rem;
      border-radius: 14px;
      max-width: 280px;
      width: 80%;
      text-align: center;
      box-shadow: 0 18px 35px rgba(15, 23, 42, 0.35);
      font-size: 0.85rem;
    }

    .modal h3 {
      margin-bottom: 0.4rem;
      font-size: 1rem;
    }
    .modal p {
      margin-bottom: 0.7rem;
      color: #444;
    }
    .modal button {
      border: none;
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      background: #16a34a;
      color: #fff;
      font-size: 0.8rem;
      cursor: pointer;
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 960px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .coupon-panel:nth-child(1),
      .coupon-panel:nth-child(3) {
        order: 2;
      }
      .tree-panel {
        order: 1;
        min-height: 360px;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>LocalFlow ì¿ í°ë‚˜ë¬´</h1>
      <p>ê°€ìš´ë° ë‚˜ë¬´ë¥¼ í„¸ì–´ë³´ì„¸ìš”. ê°€ë”, ì•„ì£¼ ê°€ë”â€¦ ì¿ í°ì´ í•˜ë‚˜ íˆ­ ë–¨ì–´ì§‘ë‹ˆë‹¤.</p>
    </header>

    <main class="layout">
      <!-- ì¢Œì¸¡ ì¿ í° ë¦¬ìŠ¤íŠ¸ -->
      <section class="coupon-panel">
        <h2>ì˜¤ëŠ˜ì˜ ì¿ í°</h2>
        <div class="coupon-grid">
          <article class="coupon-card">
            <strong>BHC ì¹˜í‚¨ í•œ ë§ˆë¦¬</strong>
            <div class="coupon-meta">
              <span>50% í• ì¸</span>
              <span>ì”ëŸ‰ 5</span>
            </div>
          </article>
          <article class="coupon-card">
            <strong>ì„±ìˆ˜ë†ì› ì²´ë¦¬ 2kg</strong>
            <div class="coupon-meta">
              <span>5,000ì› í• ì¸</span>
              <span>ì”ëŸ‰ 5</span>
            </div>
          </article>
          <article class="coupon-card">
            <strong>ë¡œì»¬ ì¹´í˜ ì•„ë©”ë¦¬ì¹´ë…¸</strong>
            <div class="coupon-meta">
              <span>1+1</span>
              <span>ì”ëŸ‰ 20</span>
            </div>
          </article>
          <!-- í•„ìš”í•˜ë©´ ê³„ì† ì¶”ê°€ -->
        </div>
      </section>

      <!-- ì¤‘ì•™ ì¿ í°ë‚˜ë¬´ -->
      <section class="tree-panel">
        <div class="tree-top-text">
          ë§ˆìš°ìŠ¤ ë˜ëŠ” ì†ê°€ë½ìœ¼ë¡œ<br />
          <strong>ì¿ í°ë‚˜ë¬´ë¥¼ ë§ˆêµ¬ í„¸ì–´ë³´ì„¸ìš”!</strong>
        </div>
        <div class="tree-area">
          <div class="tree-hitbox" id="treeHitbox" aria-label="ì¿ í°ë‚˜ë¬´ í”ë“¤ê¸°" role="button">
            <div class="tree-body" id="treeBody">
              <div class="face-blur">
                <!-- ì—¬ê¸°ì— ë„¤ ì–¼êµ´ ì‚´ì§ ë¸”ëŸ¬ ëœ ì´ë¯¸ì§€ ë„£ìœ¼ë©´ ë¨ -->
                <img src="5CF329AB-F9DE-481C-A6E4-596C7424DC66.png" alt="ë‚˜ë¬´ ì–¼êµ´" />
              </div>
              <div class="tree-trunk"></div>
            </div>
          </div>
          <!-- ë–¨ì–´ì§€ëŠ” ì¿ í°ì€ JSë¡œ ìƒì„± -->
        </div>
        <div class="tree-bottom">
          <div class="tree-stats">
            <span>ì˜¤ëŠ˜ í´ë¦­: <span id="clickCount">0</span>íšŒ</span>
            <span>íšë“ ì¿ í°: <span id="dropCount">0</span>ê°œ</span>
          </div>
          <div class="tree-hint">
            â€» ë„ˆë¬´ ë¹ ë¥´ê²Œ ì—°íƒ€í•˜ë©´ ë‚˜ë¬´ê°€ í™”ë‚¼ ìˆ˜ ìˆì–´ìš” ğŸ˜ˆ (ì¿¨íƒ€ì„ ì‚´ì§ ìˆìŒ)
          </div>
        </div>
      </section>

      <!-- ìš°ì¸¡ ì¿ í° ë¦¬ìŠ¤íŠ¸ (ì˜ˆë¹„ / ê´‘ê³  ì˜ì—­ ë“±) -->
      <section class="coupon-panel">
        <h2>ì´ë‹¬ì˜ ìŠ¤í˜ì…œ</h2>
        <div class="coupon-grid">
          <article class="coupon-card">
            <strong>ì¶©ì£¼ ì‹œë‚´ 4ì¸ ê°€ì¡± ì‹ì‚¬ê¶Œ</strong>
            <div class="coupon-meta">
              <span>15ë§Œì›ê¶Œ</span>
              <span>ì›”ê°„ë£¹</span>
            </div>
          </article>
          <article class="coupon-card">
            <strong>ì¶©ì£¼ì‚¬ë‘ìƒí’ˆê¶Œ</strong>
            <div class="coupon-meta">
              <span>1ë§Œì›ê¶Œ</span>
              <span>ì”ëŸ‰ 5</span>
            </div>
          </article>
        </div>
      </section>
    </main>
  </div>

  <!-- ëª¨ë‹¬ -->
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal">
      <h3>ì¿ í°ì´ ë–¨ì–´ì¡ŒìŠµë‹ˆë‹¤! ğŸ‰</h3>
      <p id="modalCouponText">ì˜ˆì‹œ ì¿ í° í…ìŠ¤íŠ¸</p>
      <button type="button" id="modalCloseBtn">í™•ì¸</button>
    </div>
  </div>

  <script>
    const treeHitbox = document.getElementById("treeHitbox");
    const treeBody = document.getElementById("treeBody");
    const clickCountEl = document.getElementById("clickCount");
    const dropCountEl = document.getElementById("dropCount");
    const modalBackdrop = document.getElementById("modalBackdrop");
    const modalCouponText = document.getElementById("modalCouponText");
    const modalCloseBtn = document.getElementById("modalCloseBtn");

    // ì¿ í° í’€ (ë‚˜ì¤‘ì— ì‹¤ì œ JSONìœ¼ë¡œ êµì²´ ê°€ëŠ¥)
    const couponPool = [
      "BHC ì¹˜í‚¨ í•œ ë§ˆë¦¬ 50% í• ì¸ ì¿ í°",
      "ì„±ìˆ˜ë†ì› ì²´ë¦¬ 2kg Â· 5,000ì› í• ì¸",
      "ë¡œì»¬ ì¹´í˜ ì•„ë©”ë¦¬ì¹´ë…¸ 1+1 ì¿ í°",
      "ì¶©ì£¼ì‚¬ë‘ìƒí’ˆê¶Œ 1ë§Œì›ê¶Œ"
    ];

    let clickCount = 0;
    let dropCount = 0;
    let isCooling = false;

    function randomCoupon() {
      const idx = Math.floor(Math.random() * couponPool.length);
      return couponPool[idx];
    }

    function showFallingCoupon(text) {
      const falling = document.createElement("div");
      falling.className = "falling-coupon";
      falling.innerHTML = `
        <small>ì¿ í°ë‚˜ë¬´ì—ì„œ ë–¨ì–´ì§„ ì—´ë§¤</small>
        <strong>${text}</strong>
      `;
      const treeArea = document.querySelector(".tree-area");
      treeArea.appendChild(falling);
      setTimeout(() => {
        falling.remove();
      }, 900);
    }

    function openModal(text) {
      modalCouponText.textContent = text;
      modalBackdrop.style.display = "flex";
    }

    function closeModal() {
      modalBackdrop.style.display = "none";
    }

    function handleShake() {
      // ë„ˆë¬´ ë¹ ë¥¸ ì—°íƒ€ ë°©ì§€ìš© ì¿¨íƒ€ì„
      if (isCooling) return;
      isCooling = true;
      setTimeout(() => (isCooling = false), 120);

      clickCount++;
      clickCountEl.textContent = clickCount;

      // ë‚˜ë¬´ í”ë“¤ê¸° ì• ë‹ˆë©”ì´ì…˜
      treeBody.classList.remove("shake");
      void treeBody.offsetWidth; // reflow trick
      treeBody.classList.add("shake");

      // í™•ë¥  (2% ì •ë„)
      const chance = 0.02;
      if (Math.random() < chance) {
        dropCount++;
        dropCountEl.textContent = dropCount;

        const couponText = randomCoupon();
        showFallingCoupon(couponText);
        openModal(couponText);
      }
    }

    treeHitbox.addEventListener("click", handleShake);
    treeHitbox.addEventListener("touchstart", function (e) {
      e.preventDefault();
      handleShake();
    });

    modalCloseBtn.addEventListener("click", closeModal);
    modalBackdrop.addEventListener("click", (e) => {
      if (e.target === modalBackdrop) closeModal();
    });
  </script>
</body>
</html>